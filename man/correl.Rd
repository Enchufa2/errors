% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correl.R
\name{correl}
\alias{correl}
\alias{correl}
\alias{correl<-}
\alias{correl}
\alias{set_correl}
\alias{correl}
\alias{covar}
\alias{correl}
\alias{covar<-}
\alias{correl}
\alias{set_covar}
\title{Handle Correlations Between \code{errors} Objects}
\usage{
correl(x, y)

correl(x, y) <- value

set_correl(x, y, value)

covar(x, y)

covar(x, y) <- value

set_covar(x, y, value)
}
\arguments{
\item{x}{an object of class \code{errors}.}

\item{y}{an object of class \code{errors}.}

\item{value}{a numeric vector of length 1 or the same length as \code{x}.}
}
\value{
\code{correl} and \code{covar} return a vector of correlations and
covariances respectively (or \code{NULL}).
\code{set_correl} and \code{set_covar}, which are pipe-friendly versions of
the setters, return the \code{x} object.
}
\description{
Set or retrieve correlations or covariances between \code{errors} objects.
See the details section below.
}
\details{
The uncertainties associated to \code{errors} objects are supposed
to be independent by default. If there is some known correlation, it can be
defined using these methods, and it will be used for the propagation of the
uncertainty by the mathematical and arithmetic operations.

The \code{correl} method sets or retrieves correlations, i.e., a value (or
vector of values) between \code{-1} and \code{1} (see base \code{\link{cor}}
on how to compute correlations). A covariance is just a correlation value
multiplied by the standard deviations (i.e., the standard uncertainty) of
both variables. It can be defined using the \code{covar} method (see base
\code{\link{cov}} on how to compute covariances). These methods are
equivalent; in fact, \code{correl} calls \code{covar} internally.

Every \code{errors} object has a unique ID, and pairwise correlations are
stored in an internal hash table. All the functions or methods that modify
somehow the dimensions of \code{errors} objects (i.e., subsets, binds,
concatenations, summaries...) generate new objects with new IDs, and
correlations are not, and cannot be, propagated. Only mathematical and
arithmetic operations propagate correlations, where appropriate, following
the Taylor series method.
}
\examples{
## Simultaneous resistance and reactance measurements

# Obtain mean values and uncertainty from measured values
V   <- mean(set_errors(GUM.H.2$V))
I   <- mean(set_errors(GUM.H.2$I))
phi <- mean(set_errors(GUM.H.2$phi))

# Set correlations between variables
correl(V, I)   <- with(GUM.H.2, cor(V, I))
correl(V, phi) <- with(GUM.H.2, cor(V, phi))
correl(I, phi) <- with(GUM.H.2, cor(I, phi))

# Computation of resistance, reactance and impedance values
(R <- (V / I) * cos(phi))
(X <- (V / I) * sin(phi))
(Z <- (V / I))

# Correlations between derived quantities
correl(R, X)
correl(R, Z)
correl(X, Z)

## Calibration of a thermometer

# Least-squares fit for a reference temperature of 20 degC
fit <- lm(bk ~ I(tk - 20), data = GUM.H.3)

# Extract coefficients and set correlation using the covariance matrix
y1 <- set_errors(coef(fit)[1], sqrt(vcov(fit)[1, 1]))
y2 <- set_errors(coef(fit)[2], sqrt(vcov(fit)[2, 2]))
covar(y1, y2) <- vcov(fit)[1, 2]

# Predicted correction for 30 degC
(b.30 <- y1 + y2 * set_errors(30 - 20))

}
